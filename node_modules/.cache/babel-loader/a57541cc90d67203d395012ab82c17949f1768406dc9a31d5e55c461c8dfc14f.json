{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\salig\\\\OneDrive\\\\Documents\\\\CascadeProjects\\\\windsurf-project\\\\boston-location-game\\\\src\\\\components\\\\Game.js\",\n  _s2 = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline, useMapEvents } from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\n// Remove the default icon warning\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\n  iconUrl: require('leaflet/dist/images/marker-icon.png'),\n  shadowUrl: require('leaflet/dist/images/marker-shadow.png')\n});\nconst LAUNCH_DATE = new Date('2025-07-11T00:00:00Z');\nconst Game = () => {\n  _s2();\n  var _s = $RefreshSig$();\n  const [currentLocation, setCurrentLocation] = useState(null);\n  const mapRef = useRef(null);\n  const [userPosition, setUserPosition] = useState(null); // last guess\n  const [guesses, setGuesses] = useState([]); // {latlng, distance}\n\n  const [distance, setDistance] = useState(null);\n  const [feedback, setFeedback] = useState(''); // textual hint\n  const [imageExpanded, setImageExpanded] = useState(false);\n  const [countdown, setCountdown] = useState('');\n  const [revealAnswer, setRevealAnswer] = useState(false);\n  const [shareCopied, setShareCopied] = useState(false);\n  const dayIndex = Math.floor((Date.now() - LAUNCH_DATE.getTime()) / 86400000);\n  const storageKey = `btb-state-${dayIndex}`;\n  useEffect(() => {\n    document.title = 'Beantown Browser';\n  }, []);\n  const ClickHandler = () => {\n    _s();\n    useMapEvents({\n      click: e => {\n        if (!revealAnswer) {\n          handleMapClick(e);\n        }\n      }\n    });\n    return null;\n  };\n  _s(ClickHandler, \"Ld/tk8Iz8AdZhC1l7acENaOEoCo=\", false, function () {\n    return [useMapEvents];\n  });\n  const fetchDailyLocation = async () => {\n    try {\n      const response = await fetch('http://localhost:5000/api/get-location');\n      if (!response.ok) throw new Error('Network response was not ok');\n      const data = await response.json();\n      setCurrentLocation(data);\n      // if no saved state yet, initialize fresh\n      if (!localStorage.getItem(storageKey)) {\n        setUserPosition(null);\n        setGuesses([]);\n        setFeedback('');\n        setDistance(null);\n        setRevealAnswer(false);\n      }\n      // reset map view\n      if (mapRef.current) {\n        mapRef.current.setView([42.3601, -71.0589], 13);\n      }\n    } catch (error) {\n      console.error('Error fetching location:', error);\n    }\n  };\n\n  /* ----- persistence effects ----- */\n  // restore saved state for today\n  useEffect(() => {\n    const raw = localStorage.getItem(storageKey);\n    if (raw) {\n      try {\n        const saved = JSON.parse(raw);\n        if (saved) {\n          if (saved.guesses) {\n            setGuesses(saved.guesses.map(g => ({\n              ...g,\n              latlng: L.latLng(g.latlng.lat, g.latlng.lng)\n            })));\n            if (saved.guesses.length) {\n              setUserPosition(L.latLng(saved.guesses[saved.guesses.length - 1].latlng.lat, saved.guesses[saved.guesses.length - 1].latlng.lng));\n            }\n          }\n          setDistance(saved.distance || null);\n          setFeedback(saved.feedback || '');\n          setRevealAnswer(saved.revealAnswer || false);\n        }\n      } catch (e) {\n        console.error('Failed to parse saved state', e);\n      }\n    }\n  }, [storageKey]);\n\n  // save whenever relevant state changes\n  useEffect(() => {\n    const serializableGuesses = guesses.map(g => ({\n      ...g,\n      latlng: {\n        lat: g.latlng.lat,\n        lng: g.latlng.lng\n      }\n    }));\n    const payload = {\n      guesses: serializableGuesses,\n      distance,\n      feedback,\n      revealAnswer\n    };\n    localStorage.setItem(storageKey, JSON.stringify(payload));\n  }, [guesses, distance, feedback, revealAnswer, storageKey]);\n\n  /* ----- effects ----- */\n  useEffect(() => {\n    // initial fetch\n    fetchDailyLocation();\n  }, []);\n  useEffect(() => {\n    const updateCountdown = () => {\n      const now = new Date();\n      const next = new Date();\n      next.setHours(24, 0, 0, 0);\n      const diff = next - now;\n      const h = String(Math.floor(diff / 3600000)).padStart(2, '0');\n      const m = String(Math.floor(diff % 3600000 / 60000)).padStart(2, '0');\n      const s = String(Math.floor(diff % 60000 / 1000)).padStart(2, '0');\n      setCountdown(`${h}:${m}:${s}`);\n    };\n    updateCountdown();\n    const id = setInterval(updateCountdown, 1000);\n    return () => clearInterval(id);\n  }, []);\n  const shareSymbols = {\n    blue: 'ðŸŸ¦',\n    yellow: 'ðŸŸ¨',\n    orange: 'ðŸŸ§',\n    red: 'ðŸŸ¥',\n    green: 'ðŸŸ©'\n  };\n  const arrowFromDir = {\n    'north': 'â¬†ï¸',\n    'south': 'â¬‡ï¸',\n    'east': 'âž¡ï¸',\n    'west': 'â¬…ï¸',\n    'north-east': 'â†—ï¸',\n    'north-west': 'â†–ï¸',\n    'south-east': 'â†˜ï¸',\n    'south-west': 'â†™ï¸',\n    '': 'â¬œ'\n  };\n  const handleShare = () => {\n    const todayIndex = Math.floor((Date.now() - LAUNCH_DATE.getTime()) / 86400000);\n    let text = `Beantown Browser #${todayIndex}\\nWhere do you think this picture was taken?\\n`;\n    guesses.forEach((g, idx) => {\n      const color = getColor(g.distance);\n      const sym = shareSymbols[color] || 'â¬œ';\n      const dir = directionFromGuess({\n        lat: currentLocation.lat,\n        lng: currentLocation.lng\n      }, g.latlng);\n      const arrow = revealAnswer && idx === guesses.length - 1 && distance <= WIN_THRESHOLD_KM ? '' : arrowFromDir[dir] || '';\n      text += `${sym}${arrow}\\n`;\n    });\n    if (distance !== null) {\n      text += `\\nI was ${formatDistance(distance)} away.`;\n    }\n    text += '\\nhttps://beantownbrowser.com';\n    navigator.clipboard.writeText(text).then(() => setShareCopied(true));\n  };\n  const MAX_GUESSES = 5;\n  const WIN_THRESHOLD_KM = 0.1524; // 500 ft â‰ˆ 0.1524 km\n\n  const directionFromGuess = (target, guess) => {\n    const latDiff = target.lat - guess.lat;\n    const lngDiff = target.lng - guess.lng;\n    const absLat = Math.abs(latDiff);\n    const absLng = Math.abs(lngDiff);\n    const THRESH = 0.0003; // ~30 m\n    // If both differences are tiny, user is very close\n    if (absLat < THRESH && absLng < THRESH) return 'very close';\n\n    // Decide dominant axis. If one axis difference is 1.5Ã— the other, prefer that axis only.\n    const dominantLat = absLat > absLng * 1.5;\n    const dominantLng = absLng > absLat * 1.5;\n    let parts = [];\n    if (!dominantLng && absLat >= THRESH) parts.push(latDiff > 0 ? 'north' : 'south');\n    if (!dominantLat && absLng >= THRESH) parts.push(lngDiff > 0 ? 'east' : 'west');\n    return parts.join('-');\n  };\n  const getColor = km => {\n    if (km === null || km === undefined) return 'gray';\n    if (km <= WIN_THRESHOLD_KM) return 'green'; // correct within 500 ft\n    if (km <= 0.3) return 'red'; // very close (< 0.3 km ~ 1000 ft)\n    if (km <= 1) return 'orange'; // closer (< 1 km)\n    if (km <= 2) return 'yellow'; // less far (< 2 km)\n    return 'blue'; // far\n  };\n  const memoizedIcons = {};\n  const getIcon = color => {\n    if (memoizedIcons[color]) return memoizedIcons[color];\n    memoizedIcons[color] = L.divIcon({\n      className: 'custom-marker',\n      html: `<div style=\"background:${color};width:16px;height:16px;border-radius:50%;border:2px solid white\"></div>`\n    });\n    return memoizedIcons[color];\n  };\n  const formatDistance = km => {\n    const miles = km * 0.621371;\n    if (miles >= 1) return `${miles.toFixed(2)} miles`;\n    const feet = km * 3280.84;\n    return `${Math.round(feet)} ft`;\n  };\n  const handleMapClick = e => {\n    if (revealAnswer || guesses.length >= MAX_GUESSES) return;\n    setUserPosition(e.latlng);\n    const guessIdx = guesses.length;\n    setGuesses(prev => [...prev, {\n      latlng: e.latlng,\n      distance: null\n    }]);\n    if (currentLocation) {\n      fetch('http://localhost:5000/api/check-distance', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          target_lat: currentLocation.lat,\n          target_lng: currentLocation.lng,\n          user_lat: e.latlng.lat,\n          user_lng: e.latlng.lng\n        })\n      }).then(res => res.json()).then(data => {\n        // update distance for this guess\n        setGuesses(prev => prev.map((g, i) => i === guessIdx ? {\n          ...g,\n          distance: data.distance\n        } : g));\n        if (data.distance <= WIN_THRESHOLD_KM) {\n          setDistance(data.distance);\n          setFeedback('Correct!');\n          setRevealAnswer(true);\n        } else if (guesses.length + 1 >= MAX_GUESSES) {\n          setDistance(data.distance);\n          setFeedback('Out of guesses! Revealing answer.');\n          setRevealAnswer(true);\n        } else {\n          const dir = directionFromGuess({\n            lat: currentLocation.lat,\n            lng: currentLocation.lng\n          }, e.latlng);\n          setFeedback(`Try a bit more ${dir}.`);\n        }\n      }).catch(err => console.error('Error checking distance:', err));\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"game-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Beantown Browser\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"countdown\",\n        children: [\"Next puzzle in \", countdown]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 7\n    }, this), feedback && !revealAnswer && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"hint-overlay\",\n      children: feedback\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(MapContainer, {\n      whenCreated: map => {\n        mapRef.current = map;\n      },\n      center: [42.3601, -71.0589],\n      zoom: 13,\n      style: {\n        height: '100vh',\n        width: '100vw'\n      },\n      children: [/*#__PURE__*/_jsxDEV(ClickHandler, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TileLayer, {\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n        attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }, this), revealAnswer && currentLocation && /*#__PURE__*/_jsxDEV(Marker, {\n        position: [currentLocation.lat, currentLocation.lng],\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: currentLocation.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 11\n      }, this), guesses.map((g, idx) => /*#__PURE__*/_jsxDEV(Marker, {\n        position: g.latlng,\n        icon: getIcon(getColor(g.distance)),\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: [`Guess #${idx + 1}`, revealAnswer && g.distance !== undefined && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Distance: \", formatDistance(g.distance)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 13\n        }, this)\n      }, idx, false, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 11\n      }, this)), revealAnswer && userPosition && /*#__PURE__*/_jsxDEV(Polyline, {\n        positions: [userPosition, [currentLocation.lat, currentLocation.lng]],\n        pathOptions: {\n          color: 'red',\n          dashArray: '6'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 7\n    }, this), currentLocation && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [!imageExpanded && /*#__PURE__*/_jsxDEV(\"img\", {\n        src: currentLocation.image,\n        alt: \"location thumbnail\",\n        className: \"thumbnail-img\",\n        onClick: () => setImageExpanded(true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 13\n      }, this), imageExpanded && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"img-overlay\",\n        onClick: () => setImageExpanded(false),\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: currentLocation.image,\n          alt: \"location\",\n          onClick: e => e.stopPropagation()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true), revealAnswer && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"distance-info\",\n      style: {\n        marginTop: '15px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: feedback\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 11\n      }, this), distance !== null && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"You were \", formatDistance(distance), \" away\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 33\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleShare,\n        style: {\n          marginTop: '10px'\n        },\n        children: \"Share\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 11\n      }, this), shareCopied && /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          marginLeft: '8px'\n        },\n        children: \"Copied!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 27\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 243,\n    columnNumber: 5\n  }, this);\n};\n_s2(Game, \"Ibow7djKJsUDd41OhZK+E75UW58=\");\n_c = Game;\nexport default Game;\nvar _c;\n$RefreshReg$(_c, \"Game\");","map":{"version":3,"names":["React","useState","useRef","useEffect","MapContainer","TileLayer","Marker","Popup","Polyline","useMapEvents","L","jsxDEV","_jsxDEV","Fragment","_Fragment","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","require","iconUrl","shadowUrl","LAUNCH_DATE","Date","Game","_s2","_s","$RefreshSig$","currentLocation","setCurrentLocation","mapRef","userPosition","setUserPosition","guesses","setGuesses","distance","setDistance","feedback","setFeedback","imageExpanded","setImageExpanded","countdown","setCountdown","revealAnswer","setRevealAnswer","shareCopied","setShareCopied","dayIndex","Math","floor","now","getTime","storageKey","document","title","ClickHandler","click","e","handleMapClick","fetchDailyLocation","response","fetch","ok","Error","data","json","localStorage","getItem","current","setView","error","console","raw","saved","JSON","parse","map","g","latlng","latLng","lat","lng","length","serializableGuesses","payload","setItem","stringify","updateCountdown","next","setHours","diff","h","String","padStart","m","s","id","setInterval","clearInterval","shareSymbols","blue","yellow","orange","red","green","arrowFromDir","handleShare","todayIndex","text","forEach","idx","color","getColor","sym","dir","directionFromGuess","arrow","WIN_THRESHOLD_KM","formatDistance","navigator","clipboard","writeText","then","MAX_GUESSES","target","guess","latDiff","lngDiff","absLat","abs","absLng","THRESH","dominantLat","dominantLng","parts","push","join","km","undefined","memoizedIcons","getIcon","divIcon","className","html","miles","toFixed","feet","round","guessIdx","prev","method","headers","body","target_lat","target_lng","user_lat","user_lng","res","i","catch","err","children","fileName","_jsxFileName","lineNumber","columnNumber","whenCreated","center","zoom","style","height","width","url","attribution","position","name","icon","positions","pathOptions","dashArray","src","image","alt","onClick","stopPropagation","marginTop","marginLeft","_c","$RefreshReg$"],"sources":["C:/Users/salig/OneDrive/Documents/CascadeProjects/windsurf-project/boston-location-game/src/components/Game.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\n\nimport { MapContainer, TileLayer, Marker, Popup, Polyline, useMapEvents } from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\n// Remove the default icon warning\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\n  iconUrl: require('leaflet/dist/images/marker-icon.png'),\n  shadowUrl: require('leaflet/dist/images/marker-shadow.png'),\n});\n\nconst LAUNCH_DATE = new Date('2025-07-11T00:00:00Z');\n\nconst Game = () => {\n  const [currentLocation, setCurrentLocation] = useState(null);\n  const mapRef = useRef(null);\n  const [userPosition, setUserPosition] = useState(null); // last guess\n  const [guesses, setGuesses] = useState([]); // {latlng, distance}\n\n  const [distance, setDistance] = useState(null);\n  \n  const [feedback, setFeedback] = useState(''); // textual hint\n  const [imageExpanded, setImageExpanded] = useState(false);\n  const [countdown, setCountdown] = useState('');\n  const [revealAnswer, setRevealAnswer] = useState(false);\n  const [shareCopied, setShareCopied] = useState(false);\n\n  const dayIndex = Math.floor((Date.now() - LAUNCH_DATE.getTime())/86400000);\n  const storageKey = `btb-state-${dayIndex}`;\n\n  useEffect(()=>{document.title = 'Beantown Browser';},[]);\n\n  const ClickHandler = () => {\n    useMapEvents({\n      click: (e) => {\n        if (!revealAnswer) {\n          handleMapClick(e);\n        }\n      },\n    });\n    return null;\n  };\n\n  const fetchDailyLocation = async () => {\n    try {\n      const response = await fetch('http://localhost:5000/api/get-location');\n      if (!response.ok) throw new Error('Network response was not ok');\n      const data = await response.json();\n      setCurrentLocation(data);\n      // if no saved state yet, initialize fresh\n      if(!localStorage.getItem(storageKey)){\n        setUserPosition(null);\n        setGuesses([]);\n        setFeedback('');\n        setDistance(null);\n        setRevealAnswer(false);\n      }\n      // reset map view\n      if (mapRef.current) {\n        mapRef.current.setView([42.3601, -71.0589], 13);\n      }\n    } catch (error) {\n      console.error('Error fetching location:', error);\n    }\n  };\n\n  /* ----- persistence effects ----- */\n  // restore saved state for today\n  useEffect(()=>{\n    const raw = localStorage.getItem(storageKey);\n    if(raw){\n      try{\n        const saved = JSON.parse(raw);\n        if(saved){\n          if(saved.guesses){\n          setGuesses(saved.guesses.map(g=>({\n            ...g,\n            latlng: L.latLng(g.latlng.lat, g.latlng.lng)\n          })));\n          if(saved.guesses.length){\n            setUserPosition(L.latLng(saved.guesses[saved.guesses.length-1].latlng.lat, saved.guesses[saved.guesses.length-1].latlng.lng));\n          }\n        }\n          setDistance(saved.distance||null);\n          setFeedback(saved.feedback||'');\n          setRevealAnswer(saved.revealAnswer||false);\n        }\n      }catch(e){console.error('Failed to parse saved state',e);}\n    }\n  },[storageKey]);\n\n  // save whenever relevant state changes\n  useEffect(()=>{\n    const serializableGuesses = guesses.map(g=>({\n      ...g,\n      latlng:{lat:g.latlng.lat,lng:g.latlng.lng}\n    }));\n    const payload = {guesses:serializableGuesses,distance,feedback,revealAnswer};\n    localStorage.setItem(storageKey, JSON.stringify(payload));\n  },[guesses,distance,feedback,revealAnswer,storageKey]);\n\n  /* ----- effects ----- */\n  useEffect(()=>{\n    // initial fetch\n    fetchDailyLocation();\n  },[]);\n\n  useEffect(()=>{\n    const updateCountdown = ()=>{\n      const now = new Date();\n      const next = new Date();\n      next.setHours(24,0,0,0);\n      const diff = next - now;\n      const h = String(Math.floor(diff/3600000)).padStart(2,'0');\n      const m = String(Math.floor((diff%3600000)/60000)).padStart(2,'0');\n      const s = String(Math.floor((diff%60000)/1000)).padStart(2,'0');\n      setCountdown(`${h}:${m}:${s}`);\n    };\n    updateCountdown();\n    const id=setInterval(updateCountdown,1000);\n    return ()=>clearInterval(id);\n  },[]);\n\n  const shareSymbols = {\n    blue:'ðŸŸ¦', yellow:'ðŸŸ¨', orange:'ðŸŸ§', red:'ðŸŸ¥', green:'ðŸŸ©'\n  };\n  const arrowFromDir = {\n    'north':'â¬†ï¸','south':'â¬‡ï¸','east':'âž¡ï¸','west':'â¬…ï¸',\n    'north-east':'â†—ï¸','north-west':'â†–ï¸','south-east':'â†˜ï¸','south-west':'â†™ï¸','':'â¬œ'\n  };\n\n  const handleShare = () => {\n    const todayIndex = Math.floor((Date.now() - LAUNCH_DATE.getTime())/86400000);\n    let text = `Beantown Browser #${todayIndex}\\nWhere do you think this picture was taken?\\n`;\n    guesses.forEach((g,idx)=>{\n      const color = getColor(g.distance);\n      const sym = shareSymbols[color]||'â¬œ';\n      const dir = directionFromGuess({lat:currentLocation.lat,lng:currentLocation.lng}, g.latlng);\n      const arrow = revealAnswer && idx===guesses.length-1 && distance<=WIN_THRESHOLD_KM? '' : (arrowFromDir[dir]||'');\n      text += `${sym}${arrow}\\n`;\n    });\n    if(distance!==null){\n      text += `\\nI was ${formatDistance(distance)} away.`;\n    }\n    text += '\\nhttps://beantownbrowser.com';\n    navigator.clipboard.writeText(text).then(()=> setShareCopied(true));\n  };\n\n  const MAX_GUESSES = 5;\n  const WIN_THRESHOLD_KM = 0.1524; // 500 ft â‰ˆ 0.1524 km\n\n  const directionFromGuess = (target, guess) => {\n    const latDiff = target.lat - guess.lat;\n    const lngDiff = target.lng - guess.lng;\n    const absLat = Math.abs(latDiff);\n    const absLng = Math.abs(lngDiff);\n    const THRESH = 0.0003; // ~30 m\n    // If both differences are tiny, user is very close\n    if (absLat < THRESH && absLng < THRESH) return 'very close';\n\n    // Decide dominant axis. If one axis difference is 1.5Ã— the other, prefer that axis only.\n    const dominantLat = absLat > absLng * 1.5;\n    const dominantLng = absLng > absLat * 1.5;\n\n    let parts = [];\n    if (!dominantLng && absLat >= THRESH) parts.push(latDiff > 0 ? 'north' : 'south');\n    if (!dominantLat && absLng >= THRESH) parts.push(lngDiff > 0 ? 'east' : 'west');\n\n    return parts.join('-');\n  };\n\n  const getColor = (km) => {\n    if (km === null || km === undefined) return 'gray';\n    if (km <= WIN_THRESHOLD_KM) return 'green'; // correct within 500 ft\n    if (km <= 0.3) return 'red';          // very close (< 0.3 km ~ 1000 ft)\n    if (km <= 1)   return 'orange';       // closer (< 1 km)\n    if (km <= 2)   return 'yellow';       // less far (< 2 km)\n    return 'blue';                        // far\n  };\n  \n\n  const memoizedIcons = {};\n  const getIcon = (color) => {\n    if (memoizedIcons[color]) return memoizedIcons[color];\n    memoizedIcons[color] = L.divIcon({\n      className: 'custom-marker',\n      html: `<div style=\"background:${color};width:16px;height:16px;border-radius:50%;border:2px solid white\"></div>`\n    });\n    return memoizedIcons[color];\n  };\n\n  const formatDistance = (km) => {\n    const miles = km * 0.621371;\n    if (miles >= 1) return `${miles.toFixed(2)} miles`;\n    const feet = km * 3280.84;\n    return `${Math.round(feet)} ft`;\n  };\n\n  const handleMapClick = (e) => {\n    if (revealAnswer || guesses.length >= MAX_GUESSES) return;\n    setUserPosition(e.latlng);\n    const guessIdx = guesses.length;\n    setGuesses(prev => [...prev, { latlng: e.latlng, distance: null }]);\n    \n    if (currentLocation) {\n            fetch('http://localhost:5000/api/check-distance', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          target_lat: currentLocation.lat,\n          target_lng: currentLocation.lng,\n          user_lat: e.latlng.lat,\n          user_lng: e.latlng.lng\n        })\n      })\n      .then(res => res.json())\n      .then(data => {\n        // update distance for this guess\n        setGuesses(prev => prev.map((g,i)=> i===guessIdx ? {...g, distance:data.distance}: g));\n\n        if (data.distance <= WIN_THRESHOLD_KM) {\n          setDistance(data.distance);\n          setFeedback('Correct!');\n          setRevealAnswer(true);\n        } else if (guesses.length + 1 >= MAX_GUESSES) {\n          setDistance(data.distance);\n          setFeedback('Out of guesses! Revealing answer.');\n          setRevealAnswer(true);\n        } else {\n          const dir = directionFromGuess({ lat: currentLocation.lat, lng: currentLocation.lng }, e.latlng);\n          setFeedback(`Try a bit more ${dir}.`);\n        }\n      })\n      .catch(err => console.error('Error checking distance:', err));\n\n    }\n  };\n\n  return (\n    <div className=\"game-container\">\n      <div className=\"game-header\">\n        <h1>Beantown Browser</h1>\n        <div className=\"countdown\">Next puzzle in {countdown}</div>\n      </div>\n\n      {feedback && !revealAnswer && (\n        <div className=\"hint-overlay\">{feedback}</div>\n      )}\n\n      <MapContainer \n        whenCreated={(map)=>{mapRef.current = map;}}\n        center={[42.3601, -71.0589]} \n        zoom={13}\n        style={{ height: '100vh', width: '100vw' }}\n      >\n        <ClickHandler />\n        <TileLayer\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n        />\n        \n        {revealAnswer && currentLocation && (\n          <Marker position={[currentLocation.lat, currentLocation.lng]}>\n            <Popup>\n              {currentLocation.name}\n            </Popup>\n          </Marker>\n        )}\n\n        {guesses.map((g, idx) => (\n          <Marker key={idx} position={g.latlng} icon={getIcon(getColor(g.distance))}>\n            <Popup>\n              {`Guess #${idx + 1}`}\n              {revealAnswer && g.distance !== undefined && (\n                <p>Distance: {formatDistance(g.distance)}</p>\n              )}\n            </Popup>\n          </Marker>\n        ))}\n\n\n        {/* dashed line after game ends */}\n        {revealAnswer && userPosition && (\n          <Polyline\n            positions={[userPosition, [currentLocation.lat, currentLocation.lng]]}\n            pathOptions={{ color: 'red', dashArray: '6' }}\n          />\n        )}\n      </MapContainer>\n\n      {currentLocation && (\n        <>\n          {!imageExpanded && (\n            <img\n              src={currentLocation.image}\n              alt=\"location thumbnail\"\n              className=\"thumbnail-img\"\n              onClick={() => setImageExpanded(true)}\n            />\n          )}\n          {imageExpanded && (\n            <div className=\"img-overlay\" onClick={() => setImageExpanded(false)}>\n              <img\n                src={currentLocation.image}\n                alt=\"location\"\n                onClick={(e) => e.stopPropagation()}\n              />\n            </div>\n          )}\n        </>\n      )}\n\n      {revealAnswer && (\n        <div className=\"distance-info\" style={{ marginTop: '15px' }}>\n          <h3>{feedback}</h3>\n          {distance !== null && <p>You were {formatDistance(distance)} away</p>}\n          <button onClick={handleShare} style={{marginTop:'10px'}}>Share</button>\n          {shareCopied && <span style={{marginLeft:'8px'}}>Copied!</span>}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Game;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}